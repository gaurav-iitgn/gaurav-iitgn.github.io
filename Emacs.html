<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-01-06 Mon 10:18 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs Configuration</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>

<link rel='stylesheet' href='gs_simple.css' />
<script type='text/javascript' src='gs_simple.js'></script>
</head>
<body>
<div id="preamble" class="status">

<center>
<nav>
<a href="/index.html">Home</a>
<a href="/research.html">Research</a>
<a href="/teaching.html">Teaching</a>
<a href="/students.html">Students</a>
</nav>
</center>
</div>
<div id="content" class="content">
<h1 class="title">Emacs Configuration</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org6489ceb">Startup Performance</a></li>
<li><a href="#org81d7104">Native Compilation</a></li>
<li><a href="#org05db785">System Settings</a></li>
<li><a href="#orgc214fd0">Package Management</a>
<ul>
<li><a href="#org53dbbce">straight.el</a></li>
</ul>
</li>
<li><a href="#org45a4ff9">Keep .emacs.d Clean</a></li>
<li><a href="#orgef0a959">Update Load Path</a></li>
<li><a href="#orgcb1ea30">Default Coding System</a></li>
<li><a href="#org5275472">Server Mode</a></li>
<li><a href="#orgdaf16a4">Desktop Environment</a></li>
<li><a href="#org25bad88">Keyboard Bindings</a>
<ul>
<li><a href="#orge2cd003">ESC Cancels All</a></li>
<li><a href="#org9f8ab9d">Rebind C-u</a></li>
<li><a href="#orga8009d7">Let's Be Evil</a></li>
<li><a href="#orgfb8be6c">Keybinding Panel (which-key)</a></li>
<li><a href="#orga84ef2c">Simplify Leader Bindings (general.el)</a></li>
</ul>
</li>
<li><a href="#orgdfff1b9">General Configuration</a>
<ul>
<li><a href="#org5b1108e">User Interface</a></li>
<li><a href="#org3aa96bf">Theme</a></li>
<li><a href="#org4cf10a0">Font</a>
<ul>
<li><a href="#org09272c1">Set the font</a></li>
<li><a href="#org35a2539">Enable proper Unicode glyph support</a></li>
<li><a href="#org05df6a6">Emojis in buffers</a></li>
</ul>
</li>
<li><a href="#org260efbe">Mode Line</a>
<ul>
<li><a href="#org266b808">Basic Customization</a></li>
<li><a href="#org339180d">Enable Mode Diminishing</a></li>
<li><a href="#org37d8bb2">Smart Mode Line</a></li>
<li><a href="#orgadd9579">Doom Modeline</a></li>
</ul>
</li>
<li><a href="#orgab8484f">Workspaces</a></li>
<li><a href="#org30d4982">Notifications</a></li>
<li><a href="#org164fdb6">Auto-Saving Changed Files</a></li>
<li><a href="#orga4f65dd">Auto-Reverting Changed Files</a></li>
<li><a href="#orge372a44">UI Toggles</a></li>
<li><a href="#orge825e5c">Highlight Matching Braces</a></li>
<li><a href="#orgca96a38">Displaying World Time</a></li>
<li><a href="#org493ea54">Pinentry</a></li>
<li><a href="#orga317618">TRAMP</a></li>
<li><a href="#orga03a358">Emacs as External Editor</a></li>
</ul>
</li>
<li><a href="#org2553b0d">Editing Configuration</a>
<ul>
<li><a href="#org14a91ca">Tab Widths</a></li>
<li><a href="#orgc9c0b74">Use spaces instead of tabs for indentation</a></li>
<li><a href="#org994a14f">Commenting Lines</a></li>
<li><a href="#org328b628">Automatically clean whitespace</a></li>
<li><a href="#org7fd53be">Use Parinfer for Lispy languages</a></li>
<li><a href="#orgfd8f64a">Origami.el for Folding</a></li>
</ul>
</li>
<li><a href="#org2e84f62">Configuration Files</a>
<ul>
<li><a href="#org0b03929">Configuration file management with dotcrafter.el</a></li>
<li><a href="#orgeecdd2d">Helpers</a></li>
<li><a href="#orgd83dee7">Bindings</a></li>
</ul>
</li>
<li><a href="#orgec33b64">Stateful Keymaps with Hydra</a></li>
<li><a href="#org9fd8413">Completion System</a>
<ul>
<li><a href="#orgab11100">Preserve Minibuffer History with savehist-mode</a></li>
<li><a href="#org1896fb5">Completions with Vertico</a></li>
<li><a href="#org8095c06">Completions in Regions with Corfu</a></li>
<li><a href="#org41d17bd">Improved Candidate Filtering with Orderless</a></li>
<li><a href="#org1df62ce">Consult Commands</a></li>
<li><a href="#org81029e9">Switching Directories with consult-dir</a></li>
<li><a href="#orgf50adf2">Completion Annotations with Marginalia</a></li>
<li><a href="#orgb1af35d">Completion Actions with Embark</a></li>
<li><a href="#org354f07b">Launching apps</a></li>
</ul>
</li>
<li><a href="#org872ce73">Jumping with Avy</a></li>
</ul>
</div>
</div>
<p>
This is an ongoing evolution of my original Emacs configuration files, inspired by a bunch of resources I've found online.
</p>

<div id="outline-container-org6489ceb" class="outline-2">
<h2 id="org6489ceb">Startup Performance</h2>
<div class="outline-text-2" id="text-org6489ceb">
<p>
Make startup faster by reducing the frequency of garbage collection and then use a hook to measure Emacs startup time.
</p>

<p>
Also, turn on <code>lexical-binding</code> for the init file!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">-*- lexical-binding: t; -*-</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">The default is 800 kilobytes.  Measured in bytes.</span>
(<span style="font-weight: bold;">setq</span> gc-cons-threshold (* 50 1000 1000))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Profile emacs startup</span>
(add-hook 'emacs-startup-hook
          (<span style="font-weight: bold;">lambda</span> ()
            (message <span style="font-style: italic;">"*** Emacs loaded in %s with %d garbage collections."</span>
                     (format <span style="font-style: italic;">"%.2f seconds"</span>
                             (float-time
                              (time-subtract after-init-time before-init-time)))
                     gcs-done)))

</pre>
</div>
</div>
</div>

<div id="outline-container-org81d7104" class="outline-2">
<h2 id="org81d7104">Native Compilation</h2>
<div class="outline-text-2" id="text-org81d7104">
<p>
I've started experimenting with the <code>native-comp</code> branch of Emacs for increased performance.  Here are some settings to tweak the behavior slightly:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Silence compiler warnings as they can be pretty disruptive</span>
(<span style="font-weight: bold;">setq</span> native-comp-async-report-warnings-errors nil)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Set the right directory to store the native comp cache</span>
(add-to-list 'native-comp-eln-load-path (expand-file-name <span style="font-style: italic;">"eln-cache/"</span> user-emacs-directory))

</pre>
</div>
</div>
</div>

<div id="outline-container-org05db785" class="outline-2">
<h2 id="org05db785">System Settings</h2>
<div class="outline-text-2" id="text-org05db785">
<p>
Some parts of the configuration require knowledge of whether Emacs is running on a Guix system or in Termux on Android.  Also load system-specific settings from <code>per-system-settings.el</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(load-file <span style="font-style: italic;">"~/.dotfiles/.emacs.d/lisp/dw-settings.el"</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Load settings for the first time</span>
(dw/load-system-settings)

(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">subr-x</span>)
(<span style="font-weight: bold;">setq</span> dw/is-termux
      (string-suffix-p <span style="font-style: italic;">"Android"</span> (string-trim (shell-command-to-string <span style="font-style: italic;">"uname -a"</span>))))

(<span style="font-weight: bold;">setq</span> dw/is-guix-system (<span style="font-weight: bold;">and</span> (eq system-type 'gnu/linux)
                             (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">f</span>)
                             (string-equal (f-read <span style="font-style: italic;">"/etc/issue"</span>)
                                           <span style="font-style: italic;">"\nThis is the GNU system.  Welcome.\n"</span>)))

</pre>
</div>
</div>
</div>

<div id="outline-container-orgc214fd0" class="outline-2">
<h2 id="orgc214fd0">Package Management</h2>
<div class="outline-text-2" id="text-orgc214fd0">
<p>
Set up ELPA, MELPA, and Org package repositories and load <code>use-package</code> to manage package configuration.
</p>

<p>
<b>NOTE:</b> I'm keeping this section in but disabling tangling for now because I'm trying out <code>straight.el</code> as an alternative.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Initialize package sources</span>
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">package</span>)

(<span style="font-weight: bold;">setq</span> package-archives '((<span style="font-style: italic;">"melpa"</span> . <span style="font-style: italic;">"https://melpa.org/packages/"</span>)
                         (<span style="font-style: italic;">"melpa-stable"</span> . <span style="font-style: italic;">"https://stable.melpa.org/packages/"</span>)
                         (<span style="font-style: italic;">"org"</span> . <span style="font-style: italic;">"https://orgmode.org/elpa/"</span>)
                         (<span style="font-style: italic;">"elpa"</span> . <span style="font-style: italic;">"https://elpa.gnu.org/packages/"</span>)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Fix an issue accessing the ELPA archive in Termux</span>
(<span style="font-weight: bold;">when</span> dw/is-termux
  (<span style="font-weight: bold;">setq</span> gnutls-algorithm-priority <span style="font-style: italic;">"NORMAL:-VERS-TLS1.3"</span>))

(package-initialize)
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(unless package-archive-contents</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">(package-refresh-contents))</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Initialize use-package on non-Linux platforms</span>
(<span style="font-weight: bold;">unless</span> (<span style="font-weight: bold;">or</span> (package-installed-p 'use-package)
            dw/is-guix-system)
   (package-install 'use-package))
(<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">use-package</span>)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Uncomment this to get a reading on packages that get loaded at startup</span>
<span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(setq use-package-verbose t)</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">On non-Guix systems, "ensure" packages by default</span>
(<span style="font-weight: bold;">setq</span> use-package-always-ensure (not dw/is-guix-system))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-use-package"</span>

</pre>
</div>
</div>

<div id="outline-container-org53dbbce" class="outline-3">
<h3 id="org53dbbce">straight.el</h3>
<div class="outline-text-3" id="text-org53dbbce">
<p>
Trying out <code>straight.el</code> for package management.  So far so good!
</p>

<p>
Sometimes it's good to clean up unused repositories if I've removed packages from my configuration.  Use <code>straight-remove-unused-repos</code> for this purpose.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Bootstrap straight.el</span>
(<span style="font-weight: bold;">defvar</span> <span style="font-weight: bold; font-style: italic;">bootstrap-version</span>)
(<span style="font-weight: bold;">let</span> ((bootstrap-file
      (expand-file-name <span style="font-style: italic;">"straight/repos/straight.el/bootstrap.el"</span> user-emacs-directory))
      (bootstrap-version 5))
  (<span style="font-weight: bold;">unless</span> (file-exists-p bootstrap-file)
    (<span style="font-weight: bold;">with-current-buffer</span>
        (url-retrieve-synchronously
        <span style="font-style: italic;">"https://raw.githubusercontent.com/raxod502/straight.el/develop/install.el"</span>
        'silent 'inhibit-cookies)
      (goto-char (point-max))
      (eval-print-last-sexp)))
  (load bootstrap-file nil 'nomessage))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Always use straight to install on systems other than Linux</span>
(<span style="font-weight: bold;">setq</span> straight-use-package-by-default (not (eq system-type 'gnu/linux)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Use straight.el for use-package expressions</span>
(straight-use-package 'use-package)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Clean up unused repos with `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">straight-remove-unused-repos</span><span style="font-weight: bold; font-style: italic;">'</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org45a4ff9" class="outline-2">
<h2 id="org45a4ff9">Keep .emacs.d Clean</h2>
<div class="outline-text-2" id="text-org45a4ff9">
<p>
I don't want a bunch of transient files showing up as untracked in the Git repo so I move them all to another location.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Change the user-emacs-directory to keep unwanted things out of ~/.emacs.d</span>
(<span style="font-weight: bold;">setq</span> user-emacs-directory (expand-file-name <span style="font-style: italic;">"~/.cache/emacs/"</span>)
      url-history-file (expand-file-name <span style="font-style: italic;">"url/history"</span> user-emacs-directory))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Use no-littering to automatically set common paths to the new user-emacs-directory</span>
(<span style="font-weight: bold;">use-package</span> no-littering)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Keep customization settings in a temporary file (thanks Ambrevar!)</span>
(<span style="font-weight: bold;">setq</span> custom-file
      (<span style="font-weight: bold;">if</span> (boundp 'server-socket-dir)
          (expand-file-name <span style="font-style: italic;">"custom.el"</span> server-socket-dir)
        (expand-file-name (format <span style="font-style: italic;">"emacs-custom-%s.el"</span> (user-uid)) temporary-file-directory)))
(load custom-file t)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-no-littering"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgef0a959" class="outline-2">
<h2 id="orgef0a959">Update Load Path</h2>
<div class="outline-text-2" id="text-orgef0a959">
<p>
I've got a folder of custom Emacs Lisp libraries which must be added to the load path.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Add my library path to load-path</span>
(<span style="font-weight: bold;">push</span> <span style="font-style: italic;">"~/.dotfiles/.emacs.d/lisp"</span> load-path)

</pre>
</div>
</div>
</div>

<div id="outline-container-orgcb1ea30" class="outline-2">
<h2 id="orgcb1ea30">Default Coding System</h2>
<div class="outline-text-2" id="text-orgcb1ea30">
<p>
Avoid constant errors on Windows about the coding system by setting the default to UTF-8.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(set-default-coding-systems 'utf-8)

</pre>
</div>
</div>
</div>

<div id="outline-container-org5275472" class="outline-2">
<h2 id="org5275472">Server Mode</h2>
<div class="outline-text-2" id="text-org5275472">
<p>
Start the Emacs server from this instance so that all <code>emacsclient</code> calls are routed here.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(server-start)

</pre>
</div>
</div>
</div>

<div id="outline-container-orgdaf16a4" class="outline-2">
<h2 id="orgdaf16a4">Desktop Environment</h2>
<div class="outline-text-2" id="text-orgdaf16a4">
<p>
Load up the desktop environment if on a machine that supports it and the <code>--use-exwm</code> argument was passed to Emacs on startup.  Desktop environment and window management code can be found in Desktop.org.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">setq</span> dw/exwm-enabled (<span style="font-weight: bold;">and</span> (not dw/is-termux)
                           (eq window-system 'x)
                           (seq-contains command-line-args <span style="font-style: italic;">"--use-exwm"</span>)))

(<span style="font-weight: bold;">when</span> dw/exwm-enabled
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">dw-desktop</span>))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<p>
Despite the code being in Desktop.org, include the emacs packages for the desktop environment in this file so that they can be included in the Emacs profile.
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-exwm"</span>
<span style="font-style: italic;">"emacs-desktop-environment"</span>
<span style="font-style: italic;">"emacs-stumpwm-mode"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org25bad88" class="outline-2">
<h2 id="org25bad88">Keyboard Bindings</h2>
<div class="outline-text-2" id="text-org25bad88">
</div>
<div id="outline-container-orge2cd003" class="outline-3">
<h3 id="orge2cd003">ESC Cancels All</h3>
<div class="outline-text-3" id="text-orge2cd003">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(global-set-key (kbd <span style="font-style: italic;">"&lt;escape&gt;"</span>) 'keyboard-escape-quit)

</pre>
</div>
</div>
</div>

<div id="outline-container-org9f8ab9d" class="outline-3">
<h3 id="org9f8ab9d">Rebind C-u</h3>
<div class="outline-text-3" id="text-org9f8ab9d">
<p>
Since I let <code>evil-mode</code> take over <code>C-u</code> for buffer scrolling, I need to re-bind the <code>universal-argument</code> command to another key sequence.  I'm choosing <code>C-M-u</code> for this purpose.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(global-set-key (kbd <span style="font-style: italic;">"C-M-u"</span>) 'universal-argument)

</pre>
</div>
</div>
</div>

<div id="outline-container-orga8009d7" class="outline-3">
<h3 id="orga8009d7">Let's Be Evil</h3>
<div class="outline-text-3" id="text-orga8009d7">
<p>
Some tips can be found here:
</p>

<ul class="org-ul">
<li><a href="https://github.com/noctuid/evil-guide">https://github.com/noctuid/evil-guide</a></li>
<li><a href="https://nathantypanski.com/blog/2014-08-03-a-vim-like-emacs-config.html">https://nathantypanski.com/blog/2014-08-03-a-vim-like-emacs-config.html</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dw/evil-hook</span> ()
  (<span style="font-weight: bold;">dolist</span> (mode '(custom-mode
                  eshell-mode
                  git-rebase-mode
                  erc-mode
                  circe-server-mode
                  circe-chat-mode
                  circe-query-mode
                  sauron-mode
                  term-mode))
  (add-to-list 'evil-emacs-state-modes mode)))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dw/dont-arrow-me-bro</span> ()
  (<span style="font-weight: bold;">interactive</span>)
  (message <span style="font-style: italic;">"Arrow keys are bad, you know?"</span>))

(<span style="font-weight: bold;">use-package</span> undo-tree
  <span style="font-weight: bold;">:init</span>
  (global-undo-tree-mode 1))

(<span style="font-weight: bold;">use-package</span> evil
  <span style="font-weight: bold;">:init</span>
  (<span style="font-weight: bold;">setq</span> evil-want-integration t)
  (<span style="font-weight: bold;">setq</span> evil-want-keybinding nil)
  (<span style="font-weight: bold;">setq</span> evil-want-C-u-scroll t)
  (<span style="font-weight: bold;">setq</span> evil-want-C-i-jump nil)
  (<span style="font-weight: bold;">setq</span> evil-respect-visual-line-mode t)
  (<span style="font-weight: bold;">setq</span> evil-undo-system 'undo-tree)
  <span style="font-weight: bold;">:config</span>
  (add-hook 'evil-mode-hook 'dw/evil-hook)
  (evil-mode 1)
  (define-key evil-insert-state-map (kbd <span style="font-style: italic;">"C-g"</span>) 'evil-normal-state)
  (define-key evil-insert-state-map (kbd <span style="font-style: italic;">"C-h"</span>) 'evil-delete-backward-char-and-join)

  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Use visual line motions even outside of visual-line-mode buffers</span>
  (evil-global-set-key 'motion <span style="font-style: italic;">"j"</span> 'evil-next-visual-line)
  (evil-global-set-key 'motion <span style="font-style: italic;">"k"</span> 'evil-previous-visual-line)

  (<span style="font-weight: bold;">unless</span> dw/is-termux
    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Disable arrow keys in normal and visual modes</span>
    (define-key evil-normal-state-map (kbd <span style="font-style: italic;">"&lt;left&gt;"</span>) 'dw/dont-arrow-me-bro)
    (define-key evil-normal-state-map (kbd <span style="font-style: italic;">"&lt;right&gt;"</span>) 'dw/dont-arrow-me-bro)
    (define-key evil-normal-state-map (kbd <span style="font-style: italic;">"&lt;down&gt;"</span>) 'dw/dont-arrow-me-bro)
    (define-key evil-normal-state-map (kbd <span style="font-style: italic;">"&lt;up&gt;"</span>) 'dw/dont-arrow-me-bro)
    (evil-global-set-key 'motion (kbd <span style="font-style: italic;">"&lt;left&gt;"</span>) 'dw/dont-arrow-me-bro)
    (evil-global-set-key 'motion (kbd <span style="font-style: italic;">"&lt;right&gt;"</span>) 'dw/dont-arrow-me-bro)
    (evil-global-set-key 'motion (kbd <span style="font-style: italic;">"&lt;down&gt;"</span>) 'dw/dont-arrow-me-bro)
    (evil-global-set-key 'motion (kbd <span style="font-style: italic;">"&lt;up&gt;"</span>) 'dw/dont-arrow-me-bro))

  (evil-set-initial-state 'messages-buffer-mode 'normal)
  (evil-set-initial-state 'dashboard-mode 'normal))

(<span style="font-weight: bold;">use-package</span> evil-collection
  <span style="font-weight: bold;">:after</span> evil
  <span style="font-weight: bold;">:init</span>
  (<span style="font-weight: bold;">setq</span> evil-collection-company-use-tng nil)  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Is this a bug in evil-collection?</span>
  <span style="font-weight: bold;">:custom</span>
  (evil-collection-outline-bind-tab-p nil)
  <span style="font-weight: bold;">:config</span>
  (delete 'lispy evil-collection-mode-list)
  (delete 'org-present evil-collection-mode-list)
  (evil-collection-init))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-evil"</span>
<span style="font-style: italic;">"emacs-evil-collection"</span>
<span style="font-style: italic;">"emacs-undo-tree"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgfb8be6c" class="outline-3">
<h3 id="orgfb8be6c">Keybinding Panel (which-key)</h3>
<div class="outline-text-3" id="text-orgfb8be6c">
<p>
<a href="https://github.com/justbur/emacs-which-key">which-key</a> is great for getting an overview of what keybindings are available
based on the prefix keys you entered.  Learned about this one from Spacemacs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> which-key
  <span style="font-weight: bold;">:init</span> (which-key-mode)
  <span style="font-weight: bold;">:diminish</span> which-key-mode
  <span style="font-weight: bold;">:config</span>
  (<span style="font-weight: bold;">setq</span> which-key-idle-delay 0.3))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-which-key"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orga84ef2c" class="outline-3">
<h3 id="orga84ef2c">Simplify Leader Bindings (general.el)</h3>
<div class="outline-text-3" id="text-orga84ef2c">
<p>
<a href="https://github.com/noctuid/general.el">general.el</a> is a fantastic library for defining prefixed keybindings, especially
in conjunction with Evil modes.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> general
  <span style="font-weight: bold;">:config</span>
  (general-evil-setup t)

  (general-create-definer dw/leader-key-def
    <span style="font-weight: bold;">:keymaps</span> '(normal insert visual emacs)
    <span style="font-weight: bold;">:prefix</span> <span style="font-style: italic;">"SPC"</span>
    <span style="font-weight: bold;">:global-prefix</span> <span style="font-style: italic;">"C-SPC"</span>)

  (general-create-definer dw/ctrl-c-keys
    <span style="font-weight: bold;">:prefix</span> <span style="font-style: italic;">"C-c"</span>))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-general"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdfff1b9" class="outline-2">
<h2 id="orgdfff1b9">General Configuration</h2>
<div class="outline-text-2" id="text-orgdfff1b9">
</div>
<div id="outline-container-org5b1108e" class="outline-3">
<h3 id="org5b1108e">User Interface</h3>
<div class="outline-text-3" id="text-org5b1108e">
<p>
Clean up Emacs' user interface, make it more minimal.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Thanks, but no thanks</span>
(<span style="font-weight: bold;">setq</span> inhibit-startup-message t)

(<span style="font-weight: bold;">unless</span> dw/is-termux
  (scroll-bar-mode -1)        <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Disable visible scrollbar</span>
  (tool-bar-mode -1)          <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Disable the toolbar</span>
  (tooltip-mode -1)           <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Disable tooltips</span>
  (set-fringe-mode 10))       <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Give some breathing room</span>

(menu-bar-mode -1)            <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Disable the menu bar</span>

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Set up the visible bell</span>
(<span style="font-weight: bold;">setq</span> visible-bell t)

</pre>
</div>

<p>
Improve scrolling.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">unless</span> dw/is-termux
  (<span style="font-weight: bold;">setq</span> mouse-wheel-scroll-amount '(1 ((shift) . 1))) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">one line at a time</span>
  (<span style="font-weight: bold;">setq</span> mouse-wheel-progressive-speed nil) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">don't accelerate scrolling</span>
  (<span style="font-weight: bold;">setq</span> mouse-wheel-follow-mouse 't) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">scroll window under mouse</span>
  (<span style="font-weight: bold;">setq</span> scroll-step 1) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">keyboard scroll one line at a time</span>
  (<span style="font-weight: bold;">setq</span> use-dialog-box nil)) <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Disable dialog boxes since they weren't working in Mac OSX</span>

</pre>
</div>

<p>
Set frame transparency and maximize windows by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">unless</span> dw/is-termux
  (set-frame-parameter (selected-frame) 'alpha '(90 . 90))
  (add-to-list 'default-frame-alist '(alpha . (90 . 90)))
  (set-frame-parameter (selected-frame) 'fullscreen 'maximized)
  (add-to-list 'default-frame-alist '(fullscreen . maximized)))

</pre>
</div>

<p>
Enable line numbers and customize their format.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(column-number-mode)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Enable line numbers for some modes</span>
(<span style="font-weight: bold;">dolist</span> (mode '(text-mode-hook
                prog-mode-hook
                conf-mode-hook))
  (add-hook mode (<span style="font-weight: bold;">lambda</span> () (display-line-numbers-mode 1))))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Override some modes which derive from the above</span>
(<span style="font-weight: bold;">dolist</span> (mode '(org-mode-hook))
  (add-hook mode (<span style="font-weight: bold;">lambda</span> () (display-line-numbers-mode 0))))

</pre>
</div>

<p>
Don't warn for large files (shows up when launching videos)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">setq</span> large-file-warning-threshold nil)

</pre>
</div>

<p>
Don't warn for following symlinked files
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">setq</span> vc-follow-symlinks t)

</pre>
</div>

<p>
Don't warn when advice is added for functions
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">setq</span> ad-redefinition-action 'accept)

</pre>
</div>
</div>
</div>

<div id="outline-container-org3aa96bf" class="outline-3">
<h3 id="org3aa96bf">Theme</h3>
<div class="outline-text-3" id="text-org3aa96bf">
<p>
These days I bounce around between themes included with <a href="https://github.com/hlissner/emacs-doom-themes">DOOM Themes</a> since they're well-designed and integrate with a lot of Emacs packages.
</p>

<p>
A nice gallery of Emacs themes can be found at <a href="https://emacsthemes.com/">https://emacsthemes.com/</a>.
</p>

<p>
Alternate themes:
</p>

<ul class="org-ul">
<li><code>doom-snazzy</code></li>
<li><code>doom-vibrant</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> spacegray-theme <span style="font-weight: bold;">:defer</span> t)
(<span style="font-weight: bold;">use-package</span> doom-themes <span style="font-weight: bold;">:defer</span> t)
(<span style="font-weight: bold;">unless</span> dw/is-termux
  (load-theme 'doom-palenight t)
  (doom-themes-visual-bell-config))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-doom-themes"</span>
<span style="font-style: italic;">"emacs-spacegray-theme"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org4cf10a0" class="outline-3">
<h3 id="org4cf10a0">Font</h3>
<div class="outline-text-3" id="text-org4cf10a0">
</div>
<div id="outline-container-org09272c1" class="outline-4">
<h4 id="org09272c1">Set the font</h4>
<div class="outline-text-4" id="text-org09272c1">
<p>
Different platforms need different default font sizes, and <a href="https://mozilla.github.io/Fira/">Fira Mono</a> is currently my favorite face.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Set the font face based on platform</span>
(<span style="font-weight: bold;">pcase</span> system-type
  ((<span style="font-weight: bold;">or</span> 'gnu/linux 'windows-nt 'cygwin)
   (set-face-attribute 'default nil
                       <span style="font-weight: bold;">:font</span> <span style="font-style: italic;">"JetBrains Mono"</span>
                       <span style="font-weight: bold;">:weight</span> 'light
                       <span style="font-weight: bold;">:height</span> (dw/system-settings-get 'emacs/default-face-size)))
  ('darwin (set-face-attribute 'default nil <span style="font-weight: bold;">:font</span> <span style="font-style: italic;">"Fira Mono"</span> <span style="font-weight: bold;">:height</span> 170)))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Set the fixed pitch face</span>
(set-face-attribute 'fixed-pitch nil
                    <span style="font-weight: bold;">:font</span> <span style="font-style: italic;">"JetBrains Mono"</span>
                    <span style="font-weight: bold;">:weight</span> 'light
                    <span style="font-weight: bold;">:height</span> (dw/system-settings-get 'emacs/fixed-face-size))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Set the variable pitch face</span>
(set-face-attribute 'variable-pitch nil
                    <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">:font "Cantarell"</span>
                    <span style="font-weight: bold;">:font</span> <span style="font-style: italic;">"Iosevka Aile"</span>
                    <span style="font-weight: bold;">:height</span> (dw/system-settings-get 'emacs/variable-face-size)
                    <span style="font-weight: bold;">:weight</span> 'light)

</pre>
</div>
</div>
</div>

<div id="outline-container-org35a2539" class="outline-4">
<h4 id="org35a2539">Enable proper Unicode glyph support</h4>
<div class="outline-text-4" id="text-org35a2539">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dw/replace-unicode-font-mapping</span> (block-name old-font new-font)
  (<span style="font-weight: bold;">let*</span> ((block-idx (cl-position-if
                         (<span style="font-weight: bold;">lambda</span> (i) (string-equal (car i) block-name))
                         unicode-fonts-block-font-mapping))
         (block-fonts (cadr (nth block-idx unicode-fonts-block-font-mapping)))
         (updated-block (cl-substitute new-font old-font block-fonts <span style="font-weight: bold;">:test</span> 'string-equal)))
    (<span style="font-weight: bold;">setf</span> (cdr (nth block-idx unicode-fonts-block-font-mapping))
          `(,updated-block))))

(<span style="font-weight: bold;">use-package</span> unicode-fonts
  <span style="font-weight: bold;">:disabled</span>
  <span style="font-weight: bold;">:if</span> (not dw/is-termux)
  <span style="font-weight: bold;">:custom</span>
  (unicode-fonts-skip-font-groups '(low-quality-glyphs))
  <span style="font-weight: bold;">:config</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Fix the font mappings to use the right emoji font</span>
  (mapcar
    (<span style="font-weight: bold;">lambda</span> (block-name)
      (dw/replace-unicode-font-mapping block-name <span style="font-style: italic;">"Apple Color Emoji"</span> <span style="font-style: italic;">"Noto Color Emoji"</span>))
    '(<span style="font-style: italic;">"Dingbats"</span>
      <span style="font-style: italic;">"Emoticons"</span>
      <span style="font-style: italic;">"Miscellaneous Symbols and Pictographs"</span>
      <span style="font-style: italic;">"Transport and Map Symbols"</span>))
  (unicode-fonts-setup))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">"emacs-unicode-fonts"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org05df6a6" class="outline-4">
<h4 id="org05df6a6">Emojis in buffers</h4>
<div class="outline-text-4" id="text-org05df6a6">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> emojify
  <span style="font-weight: bold;">:hook</span> (erc-mode . emojify-mode)
  <span style="font-weight: bold;">:commands</span> emojify-mode)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-emojify"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org260efbe" class="outline-3">
<h3 id="org260efbe">Mode Line</h3>
<div class="outline-text-3" id="text-org260efbe">
</div>
<div id="outline-container-org266b808" class="outline-4">
<h4 id="org266b808">Basic Customization</h4>
<div class="outline-text-4" id="text-org266b808">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">setq</span> display-time-format <span style="font-style: italic;">"%l:%M %p %b %y"</span>
      display-time-default-load-average nil)

</pre>
</div>
</div>
</div>

<div id="outline-container-org339180d" class="outline-4">
<h4 id="org339180d">Enable Mode Diminishing</h4>
<div class="outline-text-4" id="text-org339180d">
<p>
The <a href="https://github.com/myrjola/diminish.el">diminish</a> package hides pesky minor modes from the modelines.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> diminish)

</pre>
</div>
</div>
</div>

<div id="outline-container-org37d8bb2" class="outline-4">
<h4 id="org37d8bb2">Smart Mode Line</h4>
<div class="outline-text-4" id="text-org37d8bb2">
<p>
Prettify the modeline with <a href="https://github.com/Malabarba/smart-mode-line/">smart-mode-line</a>.  Really need to re-evaluate the
ordering of <code>mode-line-format</code>.  Also not sure if <code>rm-excluded-modes</code> is needed
anymore if I set up <code>diminish</code> correctly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> smart-mode-line
  <span style="font-weight: bold;">:disabled</span>
  <span style="font-weight: bold;">:if</span> dw/is-termux
  <span style="font-weight: bold;">:config</span>
  (<span style="font-weight: bold;">setq</span> sml/no-confirm-load-theme t)
  (sml/setup)
  (sml/apply-theme 'respectful)  <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Respect the theme colors</span>
  (<span style="font-weight: bold;">setq</span> sml/mode-width 'right
      sml/name-width 60)

  (<span style="font-weight: bold;">setq-default</span> mode-line-format
  `(<span style="font-style: italic;">"%e"</span>
      ,(<span style="font-weight: bold;">when</span> dw/exwm-enabled
          '(<span style="font-weight: bold;">:eval</span> (format <span style="font-style: italic;">"[%d] "</span> exwm-workspace-current-index)))
      mode-line-front-space
      evil-mode-line-tag
      mode-line-mule-info
      mode-line-client
      mode-line-modified
      mode-line-remote
      mode-line-frame-identification
      mode-line-buffer-identification
      sml/pos-id-separator
      (vc-mode vc-mode)
      <span style="font-style: italic;">" "</span>
      <span style="font-weight: bold; font-style: italic;">;</span><span style="font-weight: bold; font-style: italic;">mode-line-position</span>
      sml/pre-modes-separator
      mode-line-modes
      <span style="font-style: italic;">" "</span>
      mode-line-misc-info))

  (<span style="font-weight: bold;">setq</span> rm-excluded-modes
    (mapconcat
      'identity
      <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">These names must start with a space!</span>
      '(<span style="font-style: italic;">" GitGutter"</span> <span style="font-style: italic;">" MRev"</span> <span style="font-style: italic;">" company"</span>
      <span style="font-style: italic;">" Helm"</span> <span style="font-style: italic;">" Undo-Tree"</span> <span style="font-style: italic;">" Projectile.*"</span> <span style="font-style: italic;">" Z"</span> <span style="font-style: italic;">" Ind"</span>
      <span style="font-style: italic;">" Org-Agenda.*"</span> <span style="font-style: italic;">" ElDoc"</span> <span style="font-style: italic;">" SP/s"</span> <span style="font-style: italic;">" cider.*"</span>)
      <span style="font-style: italic;">"</span><span style="font-weight: bold; font-style: italic;">\\</span><span style="font-weight: bold; font-style: italic;">|</span><span style="font-style: italic;">"</span>)))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-smart-mode-line"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgadd9579" class="outline-4">
<h4 id="orgadd9579">Doom Modeline</h4>
<div class="outline-text-4" id="text-orgadd9579">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">You must run (all-the-icons-install-fonts) one time after</span>
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">installing this package!</span>

(<span style="font-weight: bold;">use-package</span> minions
  <span style="font-weight: bold;">:hook</span> (doom-modeline-mode . minions-mode))

(<span style="font-weight: bold;">use-package</span> doom-modeline
  <span style="font-weight: bold;">:after</span> eshell     <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Make sure it gets hooked after eshell</span>
  <span style="font-weight: bold;">:hook</span> (after-init . doom-modeline-init)
  <span style="font-weight: bold;">:custom-face</span>
  (mode-line ((t (<span style="font-weight: bold;">:height</span> 0.85))))
  (mode-line-inactive ((t (<span style="font-weight: bold;">:height</span> 0.85))))
  <span style="font-weight: bold;">:custom</span>
  (doom-modeline-height 15)
  (doom-modeline-bar-width 6)
  (doom-modeline-lsp t)
  (doom-modeline-github nil)
  (doom-modeline-mu4e nil)
  (doom-modeline-irc t)
  (doom-modeline-minor-modes t)
  (doom-modeline-persp-name nil)
  (doom-modeline-buffer-file-name-style 'truncate-except-project)
  (doom-modeline-major-mode-icon nil))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-doom-modeline"</span>
<span style="font-style: italic;">"emacs-all-the-icons"</span>
<span style="font-style: italic;">"emacs-minions"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgab8484f" class="outline-3">
<h3 id="orgab8484f">Workspaces</h3>
<div class="outline-text-3" id="text-orgab8484f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> perspective
  <span style="font-weight: bold;">:demand</span> t
  <span style="font-weight: bold;">:bind</span> ((<span style="font-style: italic;">"C-M-k"</span> . persp-switch)
         (<span style="font-style: italic;">"C-M-n"</span> . persp-next)
         (<span style="font-style: italic;">"C-x k"</span> . persp-kill-buffer*))
  <span style="font-weight: bold;">:custom</span>
  (persp-initial-frame-name <span style="font-style: italic;">"Main"</span>)
  <span style="font-weight: bold;">:config</span>
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Running `</span><span style="font-weight: bold; font-style: italic; text-decoration: underline;">persp-mode</span><span style="font-weight: bold; font-style: italic;">' multiple times resets the perspective list...</span>
  (<span style="font-weight: bold;">unless</span> (equal persp-mode t)
    (persp-mode)))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-perspective"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org30d4982" class="outline-3">
<h3 id="org30d4982">Notifications</h3>
<div class="outline-text-3" id="text-org30d4982">
<p>
<a href="https://github.com/jwiegley/alert">alert</a> is a great library for showing notifications from other packages in a variety of ways.  For now I just use it to surface desktop notifications from package code.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> alert
  <span style="font-weight: bold;">:commands</span> alert
  <span style="font-weight: bold;">:config</span>
  (<span style="font-weight: bold;">setq</span> alert-default-style 'notifications))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-alert"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org164fdb6" class="outline-3">
<h3 id="org164fdb6">Auto-Saving Changed Files</h3>
<div class="outline-text-3" id="text-org164fdb6">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> super-save
  <span style="font-weight: bold;">:defer</span> 1
  <span style="font-weight: bold;">:diminish</span> super-save-mode
  <span style="font-weight: bold;">:config</span>
  (super-save-mode +1)
  (<span style="font-weight: bold;">setq</span> super-save-auto-save-when-idle t))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-super-save"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orga4f65dd" class="outline-3">
<h3 id="orga4f65dd">Auto-Reverting Changed Files</h3>
<div class="outline-text-3" id="text-orga4f65dd">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Revert Dired and other buffers</span>
(<span style="font-weight: bold;">setq</span> global-auto-revert-non-file-buffers t)

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Revert buffers when the underlying file has changed</span>
(global-auto-revert-mode 1)

</pre>
</div>
</div>
</div>

<div id="outline-container-orge372a44" class="outline-3">
<h3 id="orge372a44">UI Toggles</h3>
<div class="outline-text-3" id="text-orge372a44">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(dw/leader-key-def
  <span style="font-style: italic;">"t"</span>  '(<span style="font-weight: bold;">:ignore</span> t <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"toggles"</span>)
  <span style="font-style: italic;">"tw"</span> 'whitespace-mode
  <span style="font-style: italic;">"tt"</span> '(counsel-load-theme <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"choose theme"</span>))

</pre>
</div>
</div>
</div>

<div id="outline-container-orge825e5c" class="outline-3">
<h3 id="orge825e5c">Highlight Matching Braces</h3>
<div class="outline-text-3" id="text-orge825e5c">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> paren
  <span style="font-weight: bold;">:config</span>
  (set-face-attribute 'show-paren-match-expression nil <span style="font-weight: bold;">:background</span> <span style="font-style: italic;">"#363e4a"</span>)
  (show-paren-mode 1))

</pre>
</div>
</div>
</div>

<div id="outline-container-orgca96a38" class="outline-3">
<h3 id="orgca96a38">Displaying World Time</h3>
<div class="outline-text-3" id="text-orgca96a38">
<p>
<code>display-time-world</code> command provides a nice display of the time at a specified
list of timezones.  Nice for working in a team with remote members.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">setq</span> display-time-world-list
  '((<span style="font-style: italic;">"Etc/UTC"</span> <span style="font-style: italic;">"UTC"</span>)
    (<span style="font-style: italic;">"America/Los_Angeles"</span> <span style="font-style: italic;">"Seattle"</span>)
    (<span style="font-style: italic;">"America/New_York"</span> <span style="font-style: italic;">"New York"</span>)
    (<span style="font-style: italic;">"Europe/Athens"</span> <span style="font-style: italic;">"Athens"</span>)
    (<span style="font-style: italic;">"Pacific/Auckland"</span> <span style="font-style: italic;">"Auckland"</span>)
    (<span style="font-style: italic;">"Asia/Shanghai"</span> <span style="font-style: italic;">"Shanghai"</span>)
    (<span style="font-style: italic;">"Asia/Kolkata"</span> <span style="font-style: italic;">"Hyderabad"</span>)))
(<span style="font-weight: bold;">setq</span> display-time-world-time-format <span style="font-style: italic;">"%a, %d %b %I:%M %p %Z"</span>)

</pre>
</div>
</div>
</div>

<div id="outline-container-org493ea54" class="outline-3">
<h3 id="org493ea54">Pinentry</h3>
<div class="outline-text-3" id="text-org493ea54">
<p>
Emacs can be prompted for the PIN of GPG private keys, we just need to set
<code>epa-pinentry-mode</code> to accomplish that:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">unless</span> (<span style="font-weight: bold;">or</span> dw/is-termux
            (eq system-type 'windows-nt))
  (<span style="font-weight: bold;">setq</span> epa-pinentry-mode 'loopback)
  (pinentry-start))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-pinentry"</span>
<span style="font-style: italic;">"pinentry-emacs"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orga317618" class="outline-3">
<h3 id="orga317618">TRAMP</h3>
<div class="outline-text-3" id="text-orga317618">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Set default connection mode to SSH</span>
(<span style="font-weight: bold;">setq</span> tramp-default-method <span style="font-style: italic;">"ssh"</span>)

</pre>
</div>
</div>
</div>

<div id="outline-container-orga03a358" class="outline-3">
<h3 id="orga03a358">Emacs as External Editor</h3>
<div class="outline-text-3" id="text-orga03a358">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dw/show-server-edit-buffer</span> (buffer)
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">TODO: Set a transient keymap to close with 'C-c C-c'</span>
  (split-window-vertically -15)
  (other-window 1)
  (set-buffer buffer))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(setq server-window #'dw/show-server-edit-buffer)</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2553b0d" class="outline-2">
<h2 id="org2553b0d">Editing Configuration</h2>
<div class="outline-text-2" id="text-org2553b0d">
</div>
<div id="outline-container-org14a91ca" class="outline-3">
<h3 id="org14a91ca">Tab Widths</h3>
<div class="outline-text-3" id="text-org14a91ca">
<p>
Default to an indentation size of 2 spaces since it's the norm for pretty much every language I use.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">setq-default</span> tab-width 2)
(<span style="font-weight: bold;">setq-default</span> evil-shift-width tab-width)

</pre>
</div>
</div>
</div>

<div id="outline-container-orgc9c0b74" class="outline-3">
<h3 id="orgc9c0b74">Use spaces instead of tabs for indentation</h3>
<div class="outline-text-3" id="text-orgc9c0b74">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">setq-default</span> indent-tabs-mode nil)

</pre>
</div>
</div>
</div>

<div id="outline-container-org994a14f" class="outline-3">
<h3 id="org994a14f">Commenting Lines</h3>
<div class="outline-text-3" id="text-org994a14f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> evil-nerd-commenter
  <span style="font-weight: bold;">:bind</span> (<span style="font-style: italic;">"M-/"</span> . evilnc-comment-or-uncomment-lines))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-evil-nerd-commenter"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org328b628" class="outline-3">
<h3 id="org328b628">Automatically clean whitespace</h3>
<div class="outline-text-3" id="text-org328b628">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> ws-butler
  <span style="font-weight: bold;">:hook</span> ((text-mode . ws-butler-mode)
         (prog-mode . ws-butler-mode)))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-ws-butler"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org7fd53be" class="outline-3">
<h3 id="org7fd53be">Use Parinfer for Lispy languages</h3>
<div class="outline-text-3" id="text-org7fd53be">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> parinfer
  <span style="font-weight: bold;">:disabled</span>
  <span style="font-weight: bold;">:hook</span> ((clojure-mode . parinfer-mode)
         (emacs-lisp-mode . parinfer-mode)
         (common-lisp-mode . parinfer-mode)
         (scheme-mode . parinfer-mode)
         (lisp-mode . parinfer-mode))
  <span style="font-weight: bold;">:config</span>
  (<span style="font-weight: bold;">setq</span> parinfer-extensions
      '(defaults       <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">should be included.</span>
        pretty-parens  <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">different paren styles for different modes.</span>
        evil           <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">If you use Evil.</span>
        smart-tab      <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">C-b &amp; C-f jump positions and smart shift with tab &amp; S-tab.</span>
        smart-yank)))  <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Yank behavior depend on mode.</span>

(dw/leader-key-def
  <span style="font-style: italic;">"tp"</span> 'parinfer-toggle-mode)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-parinfer-mode"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgfd8f64a" class="outline-3">
<h3 id="orgfd8f64a">Origami.el for Folding</h3>
<div class="outline-text-3" id="text-orgfd8f64a">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> origami
  <span style="font-weight: bold;">:hook</span> (yaml-mode . origami-mode))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-origami-el"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2e84f62" class="outline-2">
<h2 id="org2e84f62">Configuration Files</h2>
<div class="outline-text-2" id="text-org2e84f62">
</div>
<div id="outline-container-org0b03929" class="outline-3">
<h3 id="org0b03929">Configuration file management with dotcrafter.el</h3>
<div class="outline-text-3" id="text-org0b03929">
<p>
I've been working on a package called <a href="https://github.com/daviwil/dotcrafter.el">dotcrafter.el</a> for complete management of your dotfiles folder with special emphasis on configurations written with Org Mode.
</p>

<p>
Check out my <a href="https://systemcrafters.cc/learning-emacs-lisp/">Learning Emacs Lisp</a> series to see this package be written from scratch!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> dotcrafter
  <span style="font-weight: bold;">:straight</span> '(dotcrafter <span style="font-weight: bold;">:host</span> github
                          <span style="font-weight: bold;">:repo</span> <span style="font-style: italic;">"daviwil/dotcrafter.el"</span>
                          <span style="font-weight: bold;">:branch</span> <span style="font-style: italic;">"main"</span>)
  <span style="font-weight: bold;">:custom</span>
  (dotcrafter-org-files '(<span style="font-style: italic;">"Emacs.org"</span>
                          <span style="font-style: italic;">"Desktop.org"</span>
                          <span style="font-style: italic;">"Stump.org"</span>
                          <span style="font-style: italic;">"Systems.org"</span>
                          <span style="font-style: italic;">"Mail.org"</span>
                          <span style="font-style: italic;">"Workflow.org"</span>))
  <span style="font-weight: bold;">:init</span>
  (<span style="font-weight: bold;">require</span> '<span style="font-weight: bold; text-decoration: underline;">dotcrafter</span>) <span style="font-weight: bold; font-style: italic;">; </span><span style="font-weight: bold; font-style: italic;">Not sure why I have to do this...</span>
  <span style="font-weight: bold;">:config</span>
  (dotcrafter-mode))

</pre>
</div>
</div>
</div>

<div id="outline-container-orgeecdd2d" class="outline-3">
<h3 id="orgeecdd2d">Helpers</h3>
<div class="outline-text-3" id="text-orgeecdd2d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dw/org-file-jump-to-heading</span> (org-file heading-title)
  (<span style="font-weight: bold;">interactive</span>)
  (find-file (expand-file-name org-file))
  (goto-char (point-min))
  (search-forward (concat <span style="font-style: italic;">"* "</span> heading-title))
  (org-overview)
  (org-reveal)
  (org-show-subtree)
  (forward-line))

(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dw/org-file-show-headings</span> (org-file)
  (<span style="font-weight: bold;">interactive</span>)
  (find-file (expand-file-name org-file))
  (counsel-org-goto)
  (org-overview)
  (org-reveal)
  (org-show-subtree)
  (forward-line))

</pre>
</div>
</div>
</div>

<div id="outline-container-orgd83dee7" class="outline-3">
<h3 id="orgd83dee7">Bindings</h3>
<div class="outline-text-3" id="text-orgd83dee7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(dw/leader-key-def
  <span style="font-style: italic;">"fn"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (counsel-find-file <span style="font-style: italic;">"~/Notes/"</span>)) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"notes"</span>)
  <span style="font-style: italic;">"fd"</span>  '(<span style="font-weight: bold;">:ignore</span> t <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"dotfiles"</span>)
  <span style="font-style: italic;">"fdd"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (find-file <span style="font-style: italic;">"~/.dotfiles/Desktop.org"</span>)) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"desktop"</span>)
  <span style="font-style: italic;">"fde"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (find-file (expand-file-name <span style="font-style: italic;">"~/.dotfiles/Emacs.org"</span>))) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"edit config"</span>)
  <span style="font-style: italic;">"fdE"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (dw/org-file-show-headings <span style="font-style: italic;">"~/.dotfiles/Emacs.org"</span>)) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"edit config"</span>)
  <span style="font-style: italic;">"fdm"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (find-file <span style="font-style: italic;">"~/.dotfiles/Mail.org"</span>)) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"mail"</span>)
  <span style="font-style: italic;">"fdM"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (counsel-find-file <span style="font-style: italic;">"~/.dotfiles/.config/guix/manifests/"</span>)) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"manifests"</span>)
  <span style="font-style: italic;">"fds"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (dw/org-file-jump-to-heading <span style="font-style: italic;">"~/.dotfiles/Systems.org"</span> <span style="font-style: italic;">"Base Configuration"</span>)) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"base system"</span>)
  <span style="font-style: italic;">"fdS"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (dw/org-file-jump-to-heading <span style="font-style: italic;">"~/.dotfiles/Systems.org"</span> system-name)) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"this system"</span>)
  <span style="font-style: italic;">"fdp"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (dw/org-file-jump-to-heading <span style="font-style: italic;">"~/.dotfiles/Desktop.org"</span> <span style="font-style: italic;">"Panel via Polybar"</span>)) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"polybar"</span>)
  <span style="font-style: italic;">"fdw"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (find-file (expand-file-name <span style="font-style: italic;">"~/.dotfiles/Workflow.org"</span>))) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"workflow"</span>)
  <span style="font-style: italic;">"fdv"</span> '((<span style="font-weight: bold;">lambda</span> () (<span style="font-weight: bold;">interactive</span>) (find-file <span style="font-style: italic;">"~/.dotfiles/.config/vimb/config"</span>)) <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"vimb"</span>))

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgec33b64" class="outline-2">
<h2 id="orgec33b64">Stateful Keymaps with Hydra</h2>
<div class="outline-text-2" id="text-orgec33b64">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> hydra
  <span style="font-weight: bold;">:defer</span> 1)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-hydra"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org9fd8413" class="outline-2">
<h2 id="org9fd8413">Completion System</h2>
<div class="outline-text-2" id="text-org9fd8413">
<p>
Trying this as an alternative to Ivy and Counsel.
</p>
</div>

<div id="outline-container-orgab11100" class="outline-3">
<h3 id="orgab11100">Preserve Minibuffer History with savehist-mode</h3>
<div class="outline-text-3" id="text-orgab11100">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> savehist
  <span style="font-weight: bold;">:config</span>
  (<span style="font-weight: bold;">setq</span> history-length 25)
  (savehist-mode 1))

  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Individual history elements can be configured separately</span>
  <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(put 'minibuffer-history 'history-length 25)</span>
  <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(put 'evil-ex-history 'history-length 50)</span>
  <span style="font-weight: bold; font-style: italic;">;;</span><span style="font-weight: bold; font-style: italic;">(put 'kill-ring 'history-length 25))</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org1896fb5" class="outline-3">
<h3 id="org1896fb5">Completions with Vertico</h3>
<div class="outline-text-3" id="text-org1896fb5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dw/minibuffer-backward-kill</span> (arg)
  <span style="font-style: italic;">"When minibuffer is completing a file name delete up to parent</span>
<span style="font-style: italic;">folder, otherwise delete a word"</span>
  (<span style="font-weight: bold;">interactive</span> <span style="font-style: italic;">"p"</span>)
  (<span style="font-weight: bold;">if</span> minibuffer-completing-file-name
      <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Borrowed from https://github.com/raxod502/selectrum/issues/498#issuecomment-803283608</span>
      (<span style="font-weight: bold;">if</span> (string-match-p <span style="font-style: italic;">"/."</span> (minibuffer-contents))
          (zap-up-to-char (- arg) ?/)
        (delete-minibuffer-contents))
      (delete-word (- arg))))

(<span style="font-weight: bold;">use-package</span> vertico
  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">:straight '(vertico :host github</span>
  <span style="font-weight: bold; font-style: italic;">;;                     </span><span style="font-weight: bold; font-style: italic;">:repo "minad/vertico"</span>
  <span style="font-weight: bold; font-style: italic;">;;                     </span><span style="font-weight: bold; font-style: italic;">:branch "main")</span>
  <span style="font-weight: bold;">:bind</span> (<span style="font-weight: bold;">:map</span> vertico-map
         (<span style="font-style: italic;">"C-j"</span> . vertico-next)
         (<span style="font-style: italic;">"C-k"</span> . vertico-previous)
         (<span style="font-style: italic;">"C-f"</span> . vertico-exit)
         <span style="font-weight: bold;">:map</span> minibuffer-local-map
         (<span style="font-style: italic;">"M-h"</span> . dw/minibuffer-backward-kill))
  <span style="font-weight: bold;">:custom</span>
  (vertico-cycle t)
  <span style="font-weight: bold;">:custom-face</span>
  (vertico-current ((t (<span style="font-weight: bold;">:background</span> <span style="font-style: italic;">"#3a3f5a"</span>))))
  <span style="font-weight: bold;">:init</span>
  (vertico-mode))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-vertico"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org8095c06" class="outline-3">
<h3 id="org8095c06">Completions in Regions with Corfu</h3>
<div class="outline-text-3" id="text-org8095c06">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> corfu
  <span style="font-weight: bold;">:straight</span> '(corfu <span style="font-weight: bold;">:host</span> github
                    <span style="font-weight: bold;">:repo</span> <span style="font-style: italic;">"minad/corfu"</span>)
  <span style="font-weight: bold;">:bind</span> (<span style="font-weight: bold;">:map</span> corfu-map
         (<span style="font-style: italic;">"C-j"</span> . corfu-next)
         (<span style="font-style: italic;">"C-k"</span> . corfu-previous)
         (<span style="font-style: italic;">"C-f"</span> . corfu-insert))
  <span style="font-weight: bold;">:custom</span>
  (corfu-cycle t)
  <span style="font-weight: bold;">:config</span>
  (corfu-global-mode))

</pre>
</div>
</div>
</div>

<div id="outline-container-org41d17bd" class="outline-3">
<h3 id="org41d17bd">Improved Candidate Filtering with Orderless</h3>
<div class="outline-text-3" id="text-org41d17bd">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> orderless
  <span style="font-weight: bold;">:init</span>
  (<span style="font-weight: bold;">setq</span> completion-styles '(orderless)
        completion-category-defaults nil
        completion-category-overrides '((file (styles . (partial-completion))))))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-orderless"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org1df62ce" class="outline-3">
<h3 id="org1df62ce">Consult Commands</h3>
<div class="outline-text-3" id="text-org1df62ce">
<p>
Consult provides a lot of useful completion commands similar to Ivy's Counsel.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">dw/get-project-root</span> ()
  (<span style="font-weight: bold;">when</span> (fboundp 'projectile-project-root)
    (projectile-project-root)))

(<span style="font-weight: bold;">use-package</span> consult
  <span style="font-weight: bold;">:demand</span> t
  <span style="font-weight: bold;">:bind</span> ((<span style="font-style: italic;">"C-s"</span> . consult-line)
         (<span style="font-style: italic;">"C-M-l"</span> . consult-imenu)
         (<span style="font-style: italic;">"C-M-j"</span> . persp-switch-to-buffer*)
         <span style="font-weight: bold;">:map</span> minibuffer-local-map
         (<span style="font-style: italic;">"C-r"</span> . consult-history))
  <span style="font-weight: bold;">:custom</span>
  (consult-project-root-function #'dw/get-project-root)
  (completion-in-region-function #'consult-completion-in-region))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-consult"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org81029e9" class="outline-3">
<h3 id="org81029e9">Switching Directories with consult-dir</h3>
<div class="outline-text-3" id="text-org81029e9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> consult-dir
  <span style="font-weight: bold;">:straight</span> t
  <span style="font-weight: bold;">:bind</span> ((<span style="font-style: italic;">"C-x C-d"</span> . consult-dir)
         <span style="font-weight: bold;">:map</span> vertico-map
         (<span style="font-style: italic;">"C-x C-d"</span> . consult-dir)
         (<span style="font-style: italic;">"C-x C-j"</span> . consult-dir-jump-file))
  <span style="font-weight: bold;">:custom</span>
  (consult-dir-project-list-function nil))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Thanks Karthik!</span>
(<span style="font-weight: bold;">with-eval-after-load</span> 'eshell-mode
  (<span style="font-weight: bold;">defun</span> <span style="font-weight: bold;">eshell/z</span> (<span style="font-weight: bold; text-decoration: underline;">&amp;optional</span> regexp)
    <span style="font-style: italic;">"Navigate to a previously visited directory in eshell."</span>
    (<span style="font-weight: bold;">let</span> ((eshell-dirs (delete-dups (mapcar 'abbreviate-file-name
                                            (ring-elements eshell-last-dir-ring)))))
      (<span style="font-weight: bold;">cond</span>
       ((<span style="font-weight: bold;">and</span> (not regexp) (<span style="font-weight: bold;">featurep</span> '<span style="font-weight: bold; text-decoration: underline;">consult-dir</span>))
        (<span style="font-weight: bold;">let*</span> ((consult-dir--source-eshell `(<span style="font-weight: bold;">:name</span> <span style="font-style: italic;">"Eshell"</span>
                                                   <span style="font-weight: bold;">:narrow</span> ?e
                                                   <span style="font-weight: bold;">:category</span> file
                                                   <span style="font-weight: bold;">:face</span> consult-file
                                                   <span style="font-weight: bold;">:items</span> ,eshell-dirs))
               (consult-dir-sources (cons consult-dir--source-eshell consult-dir-sources)))
          (eshell/cd (substring-no-properties (consult-dir--pick <span style="font-style: italic;">"Switch directory: "</span>)))))
       (t (eshell/cd (<span style="font-weight: bold;">if</span> regexp (eshell-find-previous-directory regexp)
                       (completing-read <span style="font-style: italic;">"cd: "</span> eshell-dirs))))))))

</pre>
</div>
</div>
</div>

<div id="outline-container-orgf50adf2" class="outline-3">
<h3 id="orgf50adf2">Completion Annotations with Marginalia</h3>
<div class="outline-text-3" id="text-orgf50adf2">
<p>
Marginalia provides helpful annotations for various types of minibuffer completions.  You can think of it as a replacement of <code>ivy-rich</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> marginalia
  <span style="font-weight: bold;">:after</span> vertico
  <span style="font-weight: bold;">:custom</span>
  (marginalia-annotators '(marginalia-annotators-heavy marginalia-annotators-light nil))
  <span style="font-weight: bold;">:init</span>
  (marginalia-mode))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-marginalia"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgb1af35d" class="outline-3">
<h3 id="orgb1af35d">Completion Actions with Embark</h3>
<div class="outline-text-3" id="text-orgb1af35d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> embark
  <span style="font-weight: bold;">:bind</span> ((<span style="font-style: italic;">"C-S-a"</span> . embark-act)
         <span style="font-weight: bold;">:map</span> minibuffer-local-map
         (<span style="font-style: italic;">"C-d"</span> . embark-act))
  <span style="font-weight: bold;">:config</span>

  <span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">Show Embark actions via which-key</span>
  (<span style="font-weight: bold;">setq</span> embark-action-indicator
        (<span style="font-weight: bold;">lambda</span> (map)
          (which-key--show-keymap <span style="font-style: italic;">"Embark"</span> map nil nil 'no-paging)
          #'which-key--hide-popup-ignore-command)
        embark-become-indicator embark-action-indicator))

<span style="font-weight: bold; font-style: italic;">;; </span><span style="font-weight: bold; font-style: italic;">(use-package embark-consult</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:straight '(embark-consult :host github</span>
<span style="font-weight: bold; font-style: italic;">;;                              </span><span style="font-weight: bold; font-style: italic;">:repo "oantolin/embark"</span>
<span style="font-weight: bold; font-style: italic;">;;                              </span><span style="font-weight: bold; font-style: italic;">:files ("embark-consult.el"))</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:after (embark consult)</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:demand t</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">:hook</span>
<span style="font-weight: bold; font-style: italic;">;;   </span><span style="font-weight: bold; font-style: italic;">(embark-collect-mode . embark-consult-preview-minor-mode))</span>

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-embark"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org354f07b" class="outline-3">
<h3 id="org354f07b">Launching apps</h3>
<div class="outline-text-3" id="text-org354f07b">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> app-launcher)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-app-launcher"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org872ce73" class="outline-2">
<h2 id="org872ce73">Jumping with Avy</h2>
<div class="outline-text-2" id="text-org872ce73">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span style="font-weight: bold;">use-package</span> avy
  <span style="font-weight: bold;">:commands</span> (avy-goto-char avy-goto-word-0 avy-goto-line))

(dw/leader-key-def
  <span style="font-style: italic;">"j"</span>   '(<span style="font-weight: bold;">:ignore</span> t <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"jump"</span>)
  <span style="font-style: italic;">"jj"</span>  '(avy-goto-char <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"jump to char"</span>)
  <span style="font-style: italic;">"jw"</span>  '(avy-goto-word-0 <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"jump to word"</span>)
  <span style="font-style: italic;">"jl"</span>  '(avy-goto-line <span style="font-weight: bold;">:which-key</span> <span style="font-style: italic;">"jump to line"</span>))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span style="font-style: italic;">"emacs-avy"</span>

</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<footer>
Contact: 
<a href='mailto:gauravs@iitgn.ac.in'>gauravs@iitgn.ac.in</a> (Work) |
<a href='mailto:it.gaurav@gmail.com'>it.gaurav@gmail.com</a> (Personal)
<br>
Created completely through <a href='https://www.gnu.org/software/emacs/'>Gnu Emacs</a> and <a href='https://orgmode.org'>Org Mode</a> (<a href='https://github.com/gaurav-iitgn/gaurav-iitgn.github.io'>source code</a>)
</footer>
</div>
</body>
</html>
